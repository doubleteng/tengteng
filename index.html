<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Teng Teng | Portfolio</title>
  <meta name="description" content="Minimal academic & design portfolio with category filters." />
  <style>
    :root{
      --bg:#ffffff;--text:#111827;--sub:#6b7280;--border:#e5e7eb;--shadow:0 8px 24px rgba(0,0,0,.06);--radius:18px;
      --hero-h:350px; /* Â§¥ÂÉè‰∏ébioÂç°ÁâáÁ≠âÈ´òÔºàÊ°åÈù¢Á´ØÔºâ */
    }
    *{box-sizing:border-box} html,body{height:100%}
    body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Noto Sans,sans-serif;background:var(--bg);color:var(--text);line-height:1.6}
    a{color:var(--text);text-decoration:none} a:hover{text-decoration:underline}
    .wrap{max-width:1080px;margin:0 auto;padding:24px}

    /* Top nav (no dropdown) */
    header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 0 8px;position:sticky;top:0;background:rgba(255,255,255,.88);backdrop-filter:blur(8px);z-index:10;border-bottom:1px solid var(--border)}
    .brand{display:flex;align-items:center;gap:12px;font-weight:800}
    .brand .logo{width:36px;height:36px;border-radius:12px;background:#111827;color:#fff;display:grid;place-items:center;box-shadow:0 6px 18px rgba(0,0,0,.08)}
    nav.menu > ul{list-style:none;margin:0;padding:0;display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    nav.menu > ul > li > a{color:var(--sub);font-weight:600;display:inline-block;padding:6px 10px;border-radius:8px}
    nav.menu > ul > li > a:hover{color:var(--text);background:#f3f4f6}

    .hero{margin-top:18px;display:grid;grid-template-columns:1.2fr .8fr;gap:28px;align-items:stretch} /* Á≠âÈ´òÂÖ≥ÈîÆÔºöstretch */
    @media(max-width:900px){.hero{grid-template-columns:1fr}}
    .card{background:#fff;border:1px solid var(--border);border-radius:var(--radius);box-shadow:var(--shadow);padding:24px}

    /* Bio typography - Áº©Â∞èÊï¥‰ΩìÂ≠óÂè∑Ôºõ‰∏≠ÊñáÂêçÊõ¥Â∞èÊõ¥ÊüîÂíå */
    .bio{min-height:var(--hero-h);display:flex;flex-direction:column;justify-content:flex-start}
    .bio h1{font-size:clamp(26px,3.6vw,40px);margin:0 0 6px;line-height:1.15}
    .bio .cn{font-size:.8em;color:var(--sub);margin-left:.4rem}        /* ÔºàÊªïËÖæÔºâ */
    .bio .subtitle{color:var(--sub);margin:0 0 10px;font-weight:600;font-size:14px}
    .bio .pills{display:flex;flex-wrap:wrap;gap:8px;margin:6px 0 10px}
    .bio .pill{border:1px solid var(--border);border-radius:999px;padding:3px 9px;font-size:11px;background:#fff;color:#374151}
    .bio .lead{margin:0 0 8px;font-size:15px}
    .bio p{margin:0 0 8px;color:#374151;font-size:14px}
    .bio .more a{color:#111827;font-weight:700}

    /* Â§¥ÂÉèÔºö‰ΩøÁî®‰Ω†ÁöÑÊñá‰ª∂ÔºåÂπ∂‰∏ébioÁ≠âÈ´òÔºàÊ°åÈù¢Á´ØÔºâ */
    .avatar{
      height:var(--hero-h);
      border-radius:var(--radius);
      background:#eee url('assets/headshot%20(2).jpg') center/cover;
      border:1px solid var(--border)
    }
    @media(max-width:900px){
      .bio{min-height:auto}
      .avatar{height:320px} /* ÁßªÂä®Á´ØËá™ÁÑ∂Â†ÜÂè†ÔºåÊó†ÈúÄÁ≠âÈ´ò */
    }

    /* --- Global search (home) --- */
    .search-wrap{margin:12px 0 18px;position:relative}
    .search-input{width:100%;padding:12px 14px;border:1px solid var(--border);border-radius:12px;font-size:16px;outline:none;background:#fff}
    .search-input:focus{box-shadow:0 0 0 4px rgba(0,0,0,.05)}
    .search-panel{position:absolute;left:0;right:0;top:100%;margin-top:8px;background:#fff;border:1px solid var(--border);border-radius:14px;box-shadow:0 12px 30px rgba(0,0,0,.08);overflow:hidden;z-index:20;display:none;max-height:60vh;overflow-y:auto}
    .search-head{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;color:#6b7280;border-bottom:1px solid #f2f2f2;font-size:13px}
    .results{display:grid;gap:0}
    .result{display:flex;gap:12px;padding:12px;border-bottom:1px solid #f7f7f7;align-items:flex-start}
    .result:last-child{border-bottom:0}
    .rtype{flex:0 0 auto;display:inline-grid;place-items:center;width:28px;height:28px;border:1px solid var(--border);border-radius:8px;font-size:14px}
    .rmain{min-width:0}
    .rtitle{font-weight:800;margin:0 0 4px;font-size:15px;line-height:1.35}
    .rmeta{color:#6b7280;font-size:13px}
    .rtags{margin-top:6px;display:flex;gap:6px;flex-wrap:wrap}
    .rtag{border:1px dashed #e5e7eb;border-radius:999px;padding:2px 8px;font-size:12px;color:#4b5563}
    .rlink{margin-left:auto;align-self:center;border:1px solid #e5e7eb;border-radius:10px;padding:6px 10px;background:#fff;font-weight:700}
    .kbd{font-family:ui-monospace, SFMono-Regular, Menlo, monospace;border:1px solid #e5e7eb;border-bottom-width:2px;border-radius:6px;padding:1px 6px;background:#fff;color:#6b7280}
    @media (max-width:640px){ .rlink{display:none} }

    h2{font-size:clamp(22px,3vw,28px);margin:18px 0 10px}
    .filters{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
    .btn{display:inline-block;padding:10px 14px;border-radius:12px;border:1px solid var(--border);background:#fff;color: var(--text);font-weight:700}
    .btn[aria-pressed="true"]{background:#f3f4f6}
    .grid{display:grid;gap:16px}
    .grid.projects{grid-template-columns:repeat(3,1fr)}
    @media(max-width:900px){.grid.projects{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:600px){.grid.projects{grid-template-columns:1fr}}
    .project{display:grid;grid-template-rows:160px auto;overflow:hidden}
    .thumb{border-radius:14px;border:1px solid var(--border);background:#f3f4f6 center/cover}
    .project .meta{padding:10px 4px 0}
    .meta h3{margin:0 0 4px;font-size:16px}
    .meta p{margin:0;color:var(--sub);font-size:14px}
    .more{margin-top:12px;text-align:center}
    footer{color:var(--sub);font-size:13px;text-align:center;padding:28px 0 12px}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Header & Nav -->
    <header>
      <div class="brand"><div class="logo" aria-hidden="true">TT</div><span>Teng Teng</span></div>
      <nav aria-label="Primary" class="menu">
        <ul>
          <li><a href="./">Home</a></li>
          <li><a href="research/">Research</a></li>
          <li><a href="teaching/">Teaching</a></li>
          <li><a href="design/">Design</a></li>
          <li><a href="publications/">Publications</a></li>
          <li><a href="news/">News</a></li>
          <li><a href="about/">About</a></li>
          <li><a href="contact/">Contact</a></li>
        </ul>
      </nav>
    </header>

    <!-- Hero -->
    <main>
      <section id="home" class="hero" aria-labelledby="intro-title">
        <div class="card bio">
          <h1 id="intro-title">Teng Teng <span class="cn">(ÊªïËÖæ)</span></h1>
          <p class="subtitle">Ph.D. Candidate, University of Pennsylvania ¬∑ Incoming Assistant Professor, Lawrence Technological University (Spring 2026)</p>
          <div class="pills" aria-label="Research focus">
            <span class="pill">Computation</span>
            <span class="pill">Materials</span>
            <span class="pill">Fabrication</span>
            <span class="pill">Robotics</span>
          </div>
          <p class="lead">
            I‚Äôm an interdisciplinary researcher and architect developing high-performance building components by coupling novel construction materials with advanced fabrication and robotic systems to address environmental challenges.
          </p>
          <p>
            I‚Äôve taught and collaborated at Penn, Cornell, UW, and universities across Asia, leading courses and workshops in computational design, robotics, and fabrication. My work appears in <em>Materials &amp; Design</em>, <em>Advanced Functional Materials</em>, <em>Additive Manufacturing</em>, <em>Building and Environment</em>, and at ACADIA, eCAADe, and CAADRIA. Previously at
            <a href="https://www.arcadis.com/en/news/global/2018/7/callisonrtkl-continues-to-operate-as-a-separate-division-within-arcadis" target="_blank" rel="noopener">CallisonRTKL</a>
            I led computational design on 30+ projects across Asia, the Middle East, and North America, later co-founding Adaptive Design LLC and
            <a href="http://bbs.ncf-china.com/forum.php" target="_blank" rel="noopener">NCF</a> (a large computational design platform in China).
          </p>
          <p class="more"><a href="about/">More about me ‚Üí</a></p>
        </div>
        <div class="avatar" role="img" aria-label="Profile image"></div>
      </section>

      <!-- Site-wide search -->
      <div class="search-wrap" role="search" aria-label="Site search">
        <input id="q" class="search-input" type="search" placeholder="Search projects, publications, news‚Ä¶" autocomplete="off" />
        <div id="searchPanel" class="search-panel" aria-live="polite">
          <div class="search-head">
            <span id="countTxt">Type to search</span>
            <span><span class="kbd">Enter</span> open ¬∑ <span class="kbd">Esc</span> close</span>
          </div>
          <div class="results" id="results"></div>
        </div>
      </div>

      <!-- Projects -->
      <section id="projects" aria-labelledby="projects-title" style="margin-top:26px">
        <h2 id="projects-title">Projects</h2>
        <div class="filters" aria-label="Primary category filter">
          <button class="btn" data-filter="all" aria-pressed="true">All</button>
          <button class="btn" data-filter="research" aria-pressed="false">Research</button>
          <button class="btn" data-filter="teaching" aria-pressed="false">Teaching</button>
          <button class="btn" data-filter="design" aria-pressed="false">Design</button>
          <span style="font-size:12px;color:#6b7280;margin-left:8px;">(Show up to 9 items)</span>
        </div>

        <div class="grid projects" id="project-grid"></div>

        <div class="more">
          <a id="view-all" class="btn" href="gallery/?cat=all">View all ‚Üí</a>
        </div>
      </section>
    </main>

    <footer>¬© <span id="year"></span> Teng Teng ¬∑ Hosted on GitHub Pages</footer>
  </div>

  <!-- Shared datasets -->
  <script src="assets/js/projects.js"></script>
  <script src="assets/js/pubs.js"></script>   <!-- window.PUBS_BIB = [ ... ] -->
  <script src="assets/js/news.js"></script>   <!-- window.NEWS = [ ... ] -->

  <!-- Projects grid logic (unchanged) -->
  <script>
    document.addEventListener('DOMContentLoaded', function(){
      var yearEl = document.getElementById('year'); if(yearEl) yearEl.textContent = new Date().getFullYear();

      const projects = (window.PROJECTS||[]).slice();
      const grid = document.getElementById('project-grid');
      const buttons = Array.from(document.querySelectorAll('.filters [data-filter]'));
      const viewAll = document.getElementById('view-all');
      const MAX = 9;

      function byYearDesc(a,b){ return (b.year||0) - (a.year||0); }
      function shuffle(arr){ for(let i=arr.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [arr[i],arr[j]]=[arr[j],arr[i]]; } return arr; }
      function setPressed(target){ buttons.forEach(b=>b.setAttribute('aria-pressed', String(b===target))); }
      function cap(s){ return s.charAt(0).toUpperCase()+s.slice(1); }

      function renderCards(list){
        const omit = new Set(['research','design','teaching']);
        grid.innerHTML = list.slice(0,MAX).map(p => {
          const tags = (p.tags||[]).filter(t => !omit.has(String(t).toLowerCase())).map(cap).join(' ¬∑ ');
          const url = p.url || '#';
          const img = p.img || '';
          return `
            <a class="project card" href="${url}">
              <div class="thumb" style="background-image:url('${img}')"></div>
              <div class="meta"><h3>${p.title}</h3><p class="tag">${tags}</p></div>
            </a>
          `;
        }).join('');
      }

      function updateViewAll(cat){
        var c = cat || 'all';
        if(viewAll) viewAll.href = 'gallery/?cat=' + encodeURIComponent(c);
      }

      function applyFilter(type){
        let list;
        if(type==='all'){ list = shuffle(projects.slice()); }
        else{ list = projects.filter(p => Array.isArray(p.cats) && p.cats.includes(type)).sort(byYearDesc); }
        renderCards(list);
        updateViewAll(type);
      }

      // init: All
      applyFilter('all');

      buttons.forEach(btn=>{
        btn.addEventListener('click', ()=>{ setPressed(btn); applyFilter(btn.dataset.filter); });
      });
    });
  </script>

  <!-- Site-wide search logic -->
  <script>
  (function(){
    const el = {
      q: document.getElementById('q'),
      panel: document.getElementById('searchPanel'),
      results: document.getElementById('results'),
      count: document.getElementById('countTxt')
    };
    if(!el.q) return;

    // ---- Parse BibTeX to minimal record (title/authors/venue/year/url/doi/type) ----
    function parseBib(bib){
      const head = bib.match(/@\s*([a-zA-Z]+)\s*{\s*([^,]+),/s);
      const typeRaw = head ? head[1].toLowerCase() : '';
      const bodyStart = bib.indexOf('{', bib.indexOf('@')) + 1;
      const body = bib.slice(bodyStart, bib.lastIndexOf('}'));
      let i=0, depth=0, token='', parts=[], inQuote=false;
      while(i<body.length){
        const ch=body[i];
        if(ch === '"' && body[i-1]!=='\\'){ inQuote=!inQuote; token+=ch; i++; continue; }
        if(!inQuote){
          if(ch==='{' ) depth++;
          if(ch==='}' ) depth=Math.max(0,depth-1);
          if(ch===',' && depth===0){ parts.push(token.trim()); token=''; i++; continue; }
        }
        token+=ch; i++;
      }
      if(token.trim()) parts.push(token.trim());
      const fields={};
      for(const p of parts){
        const eq=p.indexOf('=');
        if(eq===-1) continue;
        const k=p.slice(0,eq).trim().toLowerCase();
        let v=p.slice(eq+1).trim();
        if(v.startsWith('{')&&v.endsWith('}')) v=v.slice(1,-1);
        else if(v.startsWith('"')&&v.endsWith('"')) v=v.slice(1,-1);
        fields[k]=v;
      }
      const clean=s=>(s||'').replace(/\\(bf|textbf)\s*/gi,'').replace(/[{}]/g,'');
      const title=clean(fields.title||'').trim();
      const authors=clean(fields.author||'').trim();
      const venue=clean(fields.journal||fields.booktitle||fields.school||fields.publisher||'').trim();
      const note=clean(fields.note||'').trim();
      const url=(fields.url||fields.URL||'').trim();
      const doi=/^https?:\/\/(dx\.)?doi\.org\/|^10\./i.test(url)? url : '';
      let year=0; const ym=(fields.year||'').match(/\d{4}/); if(ym) year=parseInt(ym[0],10);
      let uiType='inreview';
      if(typeRaw==='article') uiType='journal';
      else if(typeRaw==='inproceedings') uiType='conference';
      else if(typeRaw==='phdthesis' || typeRaw==='mastersthesis') uiType='thesis';
      else if(typeRaw==='incollection') uiType='book';
      else if(typeRaw==='misc') uiType='patent';
      return {type:'pub', uiType, title, authors, venue, year, url: doi||url, tags:[uiType], note};
    }

    // ---- Build unified index ----
    const projects = (window.PROJECTS||[]).map(p=>({
      type:'proj',
      uiType:(p.category||'').toLowerCase(),    // research/teaching/design (if present)
      title:p.title||'(Untitled)',
      url: p.url || null,
      year: p.year||0,
      tags: Array.isArray(p.tags)? p.tags.map(t=>String(t).toLowerCase()) : [],
      meta: (p.location||'')
    }));

    const pubs = (window.PUBS_BIB||[]).map(parseBib);

    const news = (window.NEWS||[]).map(n=>({
      type:'news',
      uiType:(n.category||'').toLowerCase(),    // research/teaching/design/lab
      title:n.title||'(Untitled)',
      url: n.link ? n.link : null,
      year: n.date ? parseInt(String(n.date).slice(0,4),10) : 0,
      date: n.date || '',
      pin: !!n.pin,
      tags: Array.isArray(n.tags)? n.tags.map(t=>String(t).toLowerCase()):[],
      meta: n.excerpt||''
    }));

    const INDEX = [...projects, ...pubs, ...news];

    // ---- Search (AND match) with simple scoring ----
    function tokenize(s){ return (s||'').toLowerCase().match(/[a-z0-9]+/g)||[]; }
    function score(item, terms){
      // fields weight: title 3, tags/authors 2, venue/meta 1, recency bonus, pin boost
      const hay = {
        title: (item.title||'').toLowerCase(),
        tags: (item.tags||[]).join(' ').toLowerCase(),
        authors: (item.authors||'').toLowerCase(),
        venue: (item.venue||'').toLowerCase(),
        meta: (item.meta||'').toLowerCase()
      };
      for(const t of terms){
        if(!(hay.title.includes(t)||hay.tags.includes(t)||hay.authors.includes(t)||hay.venue.includes(t)||hay.meta.includes(t))) return -1;
      }
      let s=0;
      for(const t of terms){
        if(hay.title.includes(t)) s+=3;
        if(hay.tags.includes(t) || hay.authors.includes(t)) s+=2;
        if(hay.venue.includes(t) || hay.meta.includes(t)) s+=1;
      }
      s += Math.min(3, Math.max(0, (item.year||0) - 2000) / 10);
      if(item.type==='news' && item.pin) s += 2;
      return s;
    }

    function icon(item){
      if(item.type==='proj') return 'üìÅ';
      if(item.type==='pub')  return 'üìÑ';
      return 'üì∞';
    }
    function typeLabel(item){
      if(item.type==='proj') return (item.uiType||'Project').replace(/^\w/,c=>c.toUpperCase());
      if(item.type==='pub'){
        const map={journal:'Journal',conference:'Conference',book:'Book',thesis:'Thesis',patent:'Patent',inreview:'In Review'};
        return map[item.uiType]||'Publication';
      }
      const map={research:'Research',teaching:'Teaching',design:'Design',lab:'Lab'};
      return map[item.uiType]||'News';
    }

    function resultHTML(item){
      const isExternal = item.url ? /^https?:\/\//i.test(item.url) : false;
      const linkAttr = item.url? `href="${item.url}" ${isExternal?'target="_blank" rel="noopener"':''}` : '';
      const openBtn = item.url? `<a class="rlink" ${linkAttr}>Open ‚Üí</a>`:'';
      const tags = (item.tags||[]).slice(0,4).map(t=>`<span class="rtag">#${t}</span>`).join('');
      const sub = item.type==='pub'
        ? [item.venue, item.year||''].filter(Boolean).join(' ¬∑ ')
        : item.type==='news'
          ? [typeLabel(item), item.date||item.year||''].filter(Boolean).join(' ¬∑ ')
          : [typeLabel(item), item.year||''].filter(Boolean).join(' ¬∑ ');
      const meta = item.type==='pub' ? (item.authors? item.authors.replace(/Teng,\s*Teng/gi,'<strong>Teng, Teng</strong>').replace(/\bTeng\s+Teng\b/gi,'<strong>Teng Teng</strong>'):'')
                                     : (item.meta||'');
      const titleAnchor = item.url? `<a ${linkAttr}>${item.title}</a>` : item.title;

      return `
      <div class="result">
        <div class="rtype" aria-hidden="true">${icon(item)}</div>
        <div class="rmain">
          <div class="rtitle">${titleAnchor}</div>
          <div class="rmeta">${sub}${meta? ' ‚Äî '+meta : ''}</div>
          ${tags? `<div class="rtags">${tags}</div>`:''}
        </div>
        ${openBtn}
      </div>`;
    }

    function render(list){
      if(!list.length){
        el.results.innerHTML = `<div class="result"><div class="rmain"><div class="rmeta">No results</div></div></div>`;
        el.count.textContent = '0 results';
        return;
      }
      el.results.innerHTML = list.map(resultHTML).join('');
      el.count.textContent = `${list.length} result${list.length>1?'s':''}`;
    }

    function run(){
      const q = (el.q.value||'').trim();
      if(!q){ el.panel.style.display='none'; el.count.textContent='Type to search'; return; }
      const terms = tokenize(q);
      const scored = INDEX.map(x=>({item:x, s:score(x, terms)})).filter(x=>x.s>=0);
      scored.sort((a,b)=> b.s - a.s);
      const top = scored.slice(0, 12).map(x=>x.item);
      render(top);
      el.panel.style.display='';
    }

    let timer=null;
    el.q.addEventListener('input', ()=>{
      clearTimeout(timer);
      timer=setTimeout(run, 80);
    });
    el.q.addEventListener('keydown', (e)=>{
      if(e.key==='Escape'){ el.panel.style.display='none'; el.q.blur(); }
      if(e.key==='Enter'){
        const firstLink = el.results.querySelector('.result a');
        if(firstLink){ firstLink.click(); }
      }
    });
    document.addEventListener('click', (e)=>{
      if(!el.panel.contains(e.target) && e.target!==el.q){
        el.panel.style.display='none';
      }
    });
  })();
  </script>
</body>
</html>
