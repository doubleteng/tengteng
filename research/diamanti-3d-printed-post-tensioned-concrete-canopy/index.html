<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>5-thumb autoplay gallery</title>
<style>
  :root{
    --bg:#fff; --text:#111827; --sub:#6b7280; --border:#e5e7eb;
    --shadow:0 8px 24px rgba(0,0,0,.06); --radius:18px;
  }
  *{box-sizing:border-box}
  body{margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Noto Sans,sans-serif; background:var(--bg); color:var(--text)}
  .wrap{max-width:1100px; margin:0 auto; padding:24px}

  /* --- gallery --- */
  .roll-gallery .thumbs{
    display:grid; grid-template-columns:repeat(5,1fr);
    gap:12px; margin:6px 0 12px;
  }
  @media (max-width:900px){
    .roll-gallery .thumbs{ grid-template-columns:repeat(5,1fr); overflow-x:auto; padding-bottom:4px }
  }
  .thumb{
    display:block; width:100%; aspect-ratio:4/3;
    background:#f3f4f6 center/cover no-repeat;
    border:1px solid var(--border); border-radius:12px;
    cursor:pointer; transition:transform .15s ease, box-shadow .15s ease, outline-color .15s ease;
    outline:2px solid transparent; outline-offset:2px;
  }
  .thumb:hover{ transform:translateY(-1px); box-shadow:var(--shadow) }
  .thumb.active{ outline-color:#11182722 }

  .feature{
    border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; background:#000;
    box-shadow:var(--shadow);
  }
  .feature img{
    display:block; width:100%; height:auto; aspect-ratio:16/9; object-fit:cover;
    opacity:0; transition:opacity .5s ease;
  }
  .feature img.fade-in{ opacity:1 }
  .feature figcaption{
    padding:10px 12px; color:var(--sub); font-size:14px; background:#fff; border-top:1px solid var(--border)
  }
</style>
</head>
<body>
<div class="wrap">

  <!-- 组件开始：5 缩略图 + 下方自动播放大图 -->
  <section class="roll-gallery" aria-label="Process / Methods slideshow">
    <div class="thumbs" id="thumbs">
      <!--
        data-full 传高清图；data-cap 为大图下方的说明文字。
        下面示例路径按你的项目替换（示例用 diamanti 路径）。
      -->
      <button class="thumb" style="background-image:url('../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-1.jpg')"
              data-full="../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-2.jpg"
              data-cap="Printing toolpath strategy" aria-label="thumb 1"></button>

      <button class="thumb" style="background-image:url('../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-2.jpg')"
              data-full="../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-3.jpg"
              data-cap="On-site assembly" aria-label="thumb 2"></button>

      <button class="thumb" style="background-image:url('../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-3.jpg')"
              data-full="../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-4.jpg"
              data-cap="Post-tensioned anchorage" aria-label="thumb 3"></button>

      <button class="thumb" style="background-image:url('../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-4.jpg')"
              data-full="../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-5.jpg"
              data-cap="Robotic printing setup" aria-label="thumb 4"></button>

      <button class="thumb" style="background-image:url('../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-5.jpg')"
              data-full="../../assets/img/diamanti-3d-printed-post-tensioned-concrete-canopy/img-6.jpg"
              data-cap="Component detail" aria-label="thumb 5"></button>
    </div>

    <figure class="feature">
      <img id="feature-img" alt="Featured image"/>
      <figcaption id="feature-cap"> </figcaption>
    </figure>
  </section>
  <!-- 组件结束 -->

</div>

<script>
(function(){
  const thumbsWrap = document.getElementById('thumbs');
  const thumbs = Array.from(thumbsWrap.querySelectorAll('.thumb'));
  const img = document.getElementById('feature-img');
  const cap = document.getElementById('feature-cap');

  // 预加载高清图，减少切换闪烁
  thumbs.forEach(t=>{
    const pic = new Image(); pic.src = t.dataset.full;
  });

  let idx = 0;
  let timer = null;
  const INTERVAL = 3000; // 3s

  function setActive(i){
    idx = (i + thumbs.length) % thumbs.length;
    const t = thumbs[idx];

    thumbs.forEach(b=>b.classList.remove('active'));
    t.classList.add('active');

    // 触发淡入
    img.classList.remove('fade-in');
    void img.offsetWidth; // 强制回流以重置过渡
    img.src = t.dataset.full;
    cap.textContent = t.dataset.cap || '';
    img.classList.add('fade-in');
  }

  function next(){ setActive(idx + 1); }
  function start(){ stop(); timer = setInterval(next, INTERVAL); }
  function stop(){ if(timer){ clearInterval(timer); timer = null; } }

  // 初始状态
  setActive(0);
  start();

  // 点击缩略图：切图 + 重启轮播
  thumbs.forEach((t,i)=>{
    t.addEventListener('click', ()=>{ setActive(i); start(); });
  });

  // 悬停暂停，移出继续
  thumbsWrap.addEventListener('mouseenter', stop);
  thumbsWrap.addEventListener('mouseleave', start);
  img.addEventListener('mouseenter', stop);
  img.addEventListener('mouseleave', start);

  // 如果图片加载较慢，首次加载完成后再淡入
  if(!img.complete){
    img.addEventListener('load', ()=>{ img.classList.add('fade-in'); }, {once:true});
  }
})();
</script>
</body>
</html>
