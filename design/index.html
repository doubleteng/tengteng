<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Design Gallery | Teng Teng</title>
<meta name="description" content="All design projects with single-select tag filter.">
<style>
  :root{--bg:#fff;--text:#111827;--sub:#6b7280;--border:#e5e7eb;--shadow:0 8px 24px rgba(0,0,0,.06);--radius:18px}
  *{box-sizing:border-box}html,body{height:100%}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Noto Sans,sans-serif;background:var(--bg);color:var(--text);line-height:1.6}
  a{color:var(--text);text-decoration:none} a:hover{text-decoration:underline}
  .wrap{max-width:1080px;margin:0 auto;padding:24px}

  /* top nav */
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 0 8px;position:sticky;top:0;background:rgba(255,255,255,.88);backdrop-filter:blur(8px);z-index:10;border-bottom:1px solid var(--border)}
  .brand{display:flex;align-items:center;gap:12px;font-weight:800}
  .brand .logo{width:36px;height:36px;border-radius:12px;background:#111827;color:#fff;display:grid;place-items:center;box-shadow:0 6px 18px rgba(0,0,0,.08)}
  nav.menu>ul{list-style:none;margin:0;padding:0;display:flex;gap:12px;align-items:center;flex-wrap:wrap}
  nav.menu>ul>li>a{color:var(--sub);font-weight:600;display:inline-block;padding:6px 10px;border-radius:8px}
  nav.menu>ul>li>a:hover{color:var(--text);background:#f3f4f6}

  /* scale content fonts */
  main{font-size:0.75em;}
  h1{font-size:clamp(17px,2.4vw,27px);margin:14px 0 12px}

  .intro-card{
    background:#fff;border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow);
    padding:20px 24px;margin:12px 0 24px;color:var(--sub);
  }
  @media (max-width:600px){ .intro-card{ padding:16px 18px; } }

  .toolbar{display:flex;align-items:center;justify-content:space-between;gap:8px;margin:8px 0 16px}
  .filters{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .chip{border:1px solid var(--border);border-radius:999px;padding:6px 9px;font-weight:700;background:#fff;cursor:pointer;font-size:.9em}
  .chip[aria-pressed="true"]{background:#f3f4f6}
  .count{color:var(--sub);font-size:12px}

  .grid{display:grid;gap:16px}
  .grid.projects{grid-template-columns:repeat(3,1fr)}
  @media(max-width:900px){.grid.projects{grid-template-columns:repeat(2,1fr)}}
  @media(max-width:600px){.grid.projects{grid-template-columns:1fr}}

  .card{background:#fff;border:1px solid var(--border);border-radius:18px;box-shadow:var(--shadow);padding:0;display:grid;grid-template-rows:160px auto}
  .thumb{border-radius:16px;margin:12px 12px 0;height:160px;border:1px solid var(--border);background:#f3f4f6 center/cover}
  .meta{padding:10px 16px 14px}
  .meta h3{margin:0 0 6px;font-size:12px}
  .meta p{margin:0;color:var(--sub);font-size:10px}

  .empty{border:1px dashed var(--border);border-radius:12px;padding:16px;text-align:center;color:var(--sub)}

  footer{color:var(--sub);font-size:13px;text-align:center;padding:28px 0 12px;margin-top:20px}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="brand"><div class="logo">TT</div><span>Teng Teng</span></div>
    <nav class="menu" aria-label="Primary">
      <ul>
        <li><a href="../">Home</a></li>
        <li><a href="../research/">Research</a></li>
        <li><a href="../teaching/">Teaching</a></li>
        <li><a href="./">Design</a></li>
        <li><a href="../publications/">Publications</a></li>
        <li><a href="../news/">News</a></li>
        <li><a href="../about/">About</a></li>
        <li><a href="../contact/">Contact</a></li>
      </ul>
    </nav>
  </header>

  <main>
    <h1>Design Gallery</h1>

    <div class="intro-card">
      My academic training has been complemented by a decade of design practice. I now focus on translating research into commercially viable, everyday products and systems across scales (space, consumer goods, hardware, interfaces). Before academia, I led computational design for mixed-use megaprojects in a global design firm, safeguarding design intent while navigating complex codes and delivery constraints. I developed parametric workflows that couple environmental data with construction processes, improving sustainability and efficiency. In my own design practice, I delivered mid-scale architecture and interior projects, and I co-led a residential development firm, gaining hands-on experience with small-scale housing and local permitting.
    </div>

    <div class="toolbar">
      <div class="filters" id="tagbar" aria-label="Tag filter (single-select)"></div>
      <div>
        <button id="clear" class="chip" aria-pressed="false" title="Clear filter">Clear</button>
        <span class="count" id="count"></span>
      </div>
    </div>

    <div class="grid projects" id="grid">
      <div class="empty" id="boot-msg">Loading projects…</div>
    </div>
  </main>

  <footer>© <span id="year"></span> Teng Teng</footer>
</div>

<noscript>
  <div class="wrap"><div class="empty">This page requires JavaScript to display projects.</div></div>
</noscript>

<!-- Load dataset first -->
<script defer src="../assets/js/projects.js"></script>
<script defer>
(function(){
  function cap(s){ s=String(s||''); return s? s.charAt(0).toUpperCase()+s.slice(1):''; }
  function showError(msg){ var g=document.getElementById('grid'); if(g){ g.innerHTML='<div class="empty">'+msg+'</div>'; } }
  function yearValue(y){
    if(typeof y==='number') return y;
    if(typeof y==='string'){ var m=y.match(/\d{4}/); return m?parseInt(m[0],10):0; }
    return 0;
  }
  function byYearDesc(a,b){ return yearValue(b.year)-yearValue(a.year); }
  function normalizeImg(url){
    url=String(url||'');
    if(!url) return '';
    if(/^https?:\/\//i.test(url) || url.charAt(0)==='/') return url; // absolute
    return '../'+url; // page is /design/, assets live at ../assets/...
  }

  function init(){
    var y=document.getElementById('year'); if(y) y.textContent=(new Date()).getFullYear();

    if(!window.PROJECTS || !window.PROJECTS.slice){
      showError('Failed to load <code>projects.js</code> (missing or has a syntax error).');
      return;
    }

    var BASE  = '../';
    var SCOPE = 'design';
    var all   = window.PROJECTS.slice();
    var projects = all.filter(function(p){ return p && p.cats && p.cats.indexOf(SCOPE) > -1; });

    var tagbar=document.getElementById('tagbar');
    var grid=document.getElementById('grid');
    var count=document.getElementById('count');
    var activeTag=null;

    var TAGS = ['architecture','product','interface','research'];
    for(var i=0;i<TAGS.length;i++){
      (function(t){
        var b=document.createElement('button');
        b.className='chip'; b.textContent=cap(t);
        b.setAttribute('data-tag',t); b.setAttribute('aria-pressed','false');
        b.addEventListener('click', function(){
          if(activeTag===t){ activeTag=null; setAll(false); }
          else{ activeTag=t; setOnly(t); }
          render();
        });
        tagbar.appendChild(b);
      })(TAGS[i]);
    }
    var clear=document.getElementById('clear');
    if(clear){ clear.addEventListener('click', function(){ activeTag=null; setAll(false); render(); }); }

    function setAll(v){
      var chips=tagbar.querySelectorAll('.chip');
      for(var i=0;i<chips.length;i++){ chips[i].setAttribute('aria-pressed', v?'true':'false'); }
    }
    function setOnly(t){
      var chips=tagbar.querySelectorAll('.chip');
      for(var i=0;i<chips.length;i++){
        var c=chips[i];
        c.setAttribute('aria-pressed', c.getAttribute('data-tag')===t?'true':'false');
      }
    }

    function metaLine(primary, p){
      var omit={'research':1,'design':1,'teaching':1};
      var tags=(p.tags||[]).filter(function(t){ return !omit[String(t).toLowerCase()]; });
      var t = tags.length ? ' · '+tags.map(cap).join(' · ') : '';
      var y = p.year ? ' · '+p.year : '';
      return (primary||'Design') + t + y;
    }

    function card(p){
      var href  = BASE + (p.url||'#');
      var bg    = normalizeImg(p.img);
      var title = p.title || '(Untitled)';
      return '<a class="card" href="'+href+'">'
           +   '<div class="thumb" style="background-image:url(\''+bg+'\')"></div>'
           +   '<div class="meta"><h3>'+title+'</h3><p>'+metaLine('Design', p)+'</p></div>'
           + '</a>';
    }

    function render(){
      try{
        var list = projects.slice().sort(byYearDesc);
        if(activeTag){
          list = list.filter(function(p){
            if(!p.tags) return false;
            for(var i=0;i<p.tags.length;i++){
              if(String(p.tags[i]).toLowerCase()===activeTag) return true;
            }
            return false;
          });
        }
        if(!list.length){
          grid.innerHTML = '<div class="empty">No projects matched the current filter.</div>';
        }else{
          var html=''; for(var i=0;i<list.length;i++){ html += card(list[i]); }
          grid.innerHTML = html;
        }
        count.textContent = list.length + ' project' + (list.length===1?'':'s');
      }catch(e){
        console.log(e);
        showError('Render failed. Open console for details.');
      }
    }

    render();
  }

  if(document.readyState==='loading'){
    document.addEventListener('DOMContentLoaded', init);
  }else{
    init();
  }

  window.addEventListener('error', function(){ showError('A script error occurred. Check the console for details.'); });
})();
</script>
</body>
</html>
